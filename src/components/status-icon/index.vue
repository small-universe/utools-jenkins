
<template>
  <div class="status-icon" style="display:inline-flex">
    <span style="width: 48px; height: 48px; " class="build-status-icon__wrapper">
      <div v-if="isWorkflow" style="position:relative; margin: -8px 0px 0px 3px">
        <span class="build-status-icon-branch__outer">
          <svg viewBox="0 0 16 16" focusable="false" class="svg-icon-branch">
            <use :xlink:href="'#status_branch'"></use>
          </svg>
        </span>
        <svg viewBox="0 0 24 24" focusable="false" :class="'svg-icon ' + name">
            <use :xlink:href="'#status_' + name"></use>
          </svg>
      </div>
      <div v-else>
        <span class="build-status-icon__outer">
          <svg viewBox="0 0 24 24" focusable="false" :class="anime ? 'svg-icon icon-anime ' + color: 'svg-icon ' + color">
            <use :xlink:href="anime ? '#status_build-status-in-progress' : '#status_build-status-static'"></use>
          </svg>
        </span>
        <svg viewBox="0 0 24 24" focusable="false" :class="'svg-icon ' + color">
          <use :xlink:href="'#status_' + name"></use>
        </svg>
      </div>
    </span>
  </div>
</template>
<script lang="ts">
import { defineComponent } from 'vue'

export default defineComponent({
    name: "StatusIcon",
    props: {
        name: {
            type: String,
            required: true,
        },
        color: {
            type: String,
            required: true,
        },
        anime: {
            type: Boolean,
            required: false,
            default: true
        },
        isWorkflow: {
            type: Boolean,
            required: false,
            default: false
        }
    },
    setup() {
        //获取当前svg目录所有为.svg结尾的文件
        const req = require.context('@/assets/svg', true, /\.svg$/)

        // 解析获取的.svg文件的文件名称，并返回
        const requireAll = (requireContext: __WebpackModuleApi.RequireContext) => {
            return requireContext.keys().map(requireContext)
        }
        requireAll(req)
    },
})
</script>

<style scoped>
  .status-icon {
    vertical-align: middle;
    width: 48px;
  }
  .build-status-icon__wrapper {
      display: inline-block;
      position: relative;
  }
  .build-status-icon__outer {
    display: block;
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    transform: translate(-50%, -50%);
  }
  .build-status-icon-branch__outer {
    display: block;
    position: absolute;
    top: 50%;
    right: 80;
    right: 45%;
    width: 100%;
    height: 100%;
    transform: rotate(90deg);
  }
  
  .svg-icon {
    display: inline-block;
    vertical-align: middle;
    height: 100%;
    width: 100%;
    fill: #333;
  }
  .icon-anime {
    -webkit-animation: spin-reverse 2s linear infinite;
    animation: spin-reverse 2s linear infinite;
    will-change: transform;
  }
  .icon-nobuilt{
    color: #0b6aa2;
    fill: #0b6aa2;
  }
  .icon-disabled{
    color: #333;
    fill: #333;
    opacity: 0.5;
  }
  .icon-aborted{
    color: #333;
    fill: #333;
  }
  .icon-blue{
    color: #138347;
    fill: #138347;
  }
  .icon-yellow{
    color: #ff9800;
    fill: #ff9800;
  }
  .icon-red{
    color: #cc0003;
    fill: #cc0003;
  }
  @-webkit-keyframes spin-reverse {
    from {
      transform: rotate(360deg);
    }
    to {
      transform: rotate(0deg);
    }
  }
  @keyframes spin-reverse {
    from {
      transform: rotate(360deg);
    }
    to {
      transform: rotate(0deg);
    }
  }
</style>
